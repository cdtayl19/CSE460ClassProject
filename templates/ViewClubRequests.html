<!DOCTYPE html>
<head>
  <title>View Club Requests</title>

  <!--<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">-->
</head>

<body>
    <div class="starter-container">
        <h2>Club Requests</h2>
        <div id="display">
            <p id="user"></p>
            <p id="name"></p>
            <p id="topic"></p>
            <label></label><br>
            <textarea id="description" rows="4" cols="50"></textarea><br><br>
        </div>
        <button id="prevBtn">Prev</button>
        <button id="nextBtn">Next</button>
        <button id="approveBtn">Approve</button>
        <button id="goBackBtn">Back</button>
    </div>

    <script>
        let currentIndex = 0;
        
        async function getClubRequest(index) {
            const response = await fetch(`/get-club-request?index=${index}`, {
                method: "GET",
                headers: { 
                    "Content-Type": "application/json" 
                },
            });
            
            data = await response.json();
            return data;
        }
    
        window.addEventListener("DOMContentLoaded", async () => {
            let data = await getClubRequest(currentIndex);

            console.log(data.data);

            if (data.status === "success") {
                document.getElementById("user").innerHTML = "Submitted by: " + data.data["Submitted By"];
                document.getElementById("name").innerHTML = "Club Name: " + data.data["Club Name"];
                document.getElementById("topic").innerHTML = "Topic: " + data.data["Topic"];
                document.getElementById("description").innerHTML = data.data["Details"];
            } else {
                document.getElementById("description").innerHTML = data.message;
            }            
        });

        document.getElementById("prevBtn").addEventListener("click", async () => {
            currentIndex--;
            let data = await getClubRequest(currentIndex);

            if (data.status === "success") {
                document.getElementById("user").innerHTML = "Submitted by: " + data.data["Submitted By"];
                document.getElementById("name").innerHTML = "Club Name: " + data.data["Club Name"];
                document.getElementById("topic").innerHTML = "Topic: " + data.data["Topic"];
                document.getElementById("description").innerHTML = data.data["Details"];
            } else {
                console.error(data.message);
            }
        });

        document.getElementById("nextBtn").addEventListener("click", async () => {
            currentIndex++;
            let data = await getClubRequest(currentIndex);

            if (data.status === "success") {
                document.getElementById("user").innerHTML = "Submitted by: " + data.data["Submitted By"];
                document.getElementById("name").innerHTML = "Club Name: " + data.data["Club Name"];
                document.getElementById("topic").innerHTML = "Topic: " + data.data["Topic"];
                document.getElementById("description").innerHTML = data.data["Details"];
            } else {
                console.error(data.message);
            }
        });

        document.getElementById("goBackBtn").addEventListener("click", () => {
          window.location.href = '/admin';
        });
    </script>
</body>
</html>